vcpkg_check_linkage(ONLY_STATIC_LIBRARY)

vcpkg_from_github(OUT_SOURCE_PATH SOURCE_PATH
    REPO lighttransport/tinyusdz
    REF bd2a1edbbf69f352a6c40730114db9918c384848
    HEAD_REF master
    SHA512 1d075d8678dfd8416929f20f4c258d716cc217fe14d9e0c363b320f1c58d19dc230705b9469ed2dccc00228d386f92d0ebd2ee6a1ed4f57a676d0f046f324a07
    PATCHES
        arm32.patch
        cmake_install.patch
)
vcpkg_cmake_configure(
    SOURCE_PATH ${SOURCE_PATH}
    OPTIONS
        -DBUILD_SHARED_LIBS=OFF
        -DTINYUSDZ_DEFAULT_WITH_C_API=OFF
        -DTINYUSDZ_DEFAULT_BUILD_TESTS=OFF
        -DTINYUSDZ_DEFAULT_BUILD_EXAMPLES=OFF
        -DTINYUSDZ_DEFAULT_WITH_BUILTIN_IMAGE_LOADER=ON
        -DTINYUSDZ_DEFAULT_WITH_PXR_COMPAT_API=ON
        -DTINYUSDZ_DEFAULT_WITH_OPENSUBDIV=OFF
        -DTINYUSDZ_DEFAULT_WITH_ALAC_AUDIO=OFF
        -DTINYUSDZ_DEFAULT_WITH_TIFF=OFF
        -DTINYUSDZ_DEFAULT_WITH_EXR=OFF
        -DTINYUSDZ_DEFAULT_WITH_USDVOX=OFF
        -DTINYUSDZ_DEFAULT_WITH_USDOBJ=OFF
        -DTINYUSDZ_DEFAULT_WITH_USDFBX=OFF
        -DTINYUSDZ_DEFAULT_WITH_JSON=OFF
        -DTINYUSDZ_DEFAULT_WITH_USDMTLX=OFF
        -DTINYUSDZ_DEFAULT_WITH_PYTHON=OFF
        -DTINYUSDZ_DEFAULT_WITH_COLORIO=OFF
        -DTINYUSDZ_USE_SYSTEM_ZLIB=ON
)
vcpkg_copy_pdbs()
vcpkg_cmake_install()
vcpkg_cmake_config_fixup(CONFIG_PATH lib/cmake/tinyusdz)

file(INSTALL ${SOURCE_PATH}/LICENSE DESTINATION ${CURRENT_PACKAGES_DIR}/share/${PORT} RENAME copyright)
